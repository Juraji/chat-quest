<div class="container-fluid d-flex flex-column chat-session-container">
  <app-page-header backUrl="../">
    <span class="page-title">{{ chatSessionName() }}</span>
    <button type="button" class="btn btn-outline-secondary"
            title="Toggle focus-mode"
            (click)="focusMode.toggle()">
      @if (focusMode()) {
        <span class="bi bi-eye-slash"></span>
      } @else {
        <span class="bi bi-eye"></span>
      }
    </button>
  </app-page-header>

  <div class="grid gap-3 flex-grow-1 overflow-y-hidden chat-grid">
    @if (!focusMode()) {
      <div class="g-col-3 h-100 pb-4 overflow-y-auto chat-grid-column">
        <chat-session-details-block class="d-block mb-3"/>
        <memory-list [worldId]="worldId()"/>
      </div>
    }
    <div class="g-col-6 h-100 overflow-y-hidden d-flex flex-column gap-2 chat-grid-column"
         [class.g-start-4]="focusMode()">
      <div #chatMessagesContainer
           class="d-block flex-grow-1 overflow-y-scroll position-relative">
        @for (m of messages(); track m.id) {
          <chat-session-message class="d-block mb-3" [message]="m"/>
        }
      </div>
      <chat-session-chat-input-block class="d-block mb-2"/>
    </div>
    @if (!focusMode()) {
      <div class="g-col-3 h-100 pb-4 overflow-y-auto chat-grid-column"
           [class.visually-hidden]="focusMode()">
        <chat-session-participants-block/>
      </div>
    }
  </div>
</div>
