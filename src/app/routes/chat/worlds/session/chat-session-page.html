<div class="container-fluid d-flex flex-column chat-session-container">
  <app-page-header backUrl="../">
    <span class="page-title">{{ chatSessionName() }}</span>
  </app-page-header>

  <div class="grid gap-3 flex-grow-1 overflow-y-hidden chat-grid">
    <div class="g-col-3 h-100 pb-4 overflow-y-auto chat-grid-column">
      <chat-session-edit-base-session-block
        class="d-block mb-3"
        [world]="world()"
        [chatSession]="chatSession()"/>
      <chat-session-participants-block
        [worldId]="worldId()"
        [chatSessionId]="chatSessionId()"
        [allCharacters]="allCharacters()"
        [participants]="participants()"/>
    </div>
    <div class="g-col-6 h-100 overflow-y-hidden d-flex flex-column gap-2 chat-grid-column">
      <div #chatMessagesContainer
           class="d-block flex-grow-1 overflow-y-scroll">
        @for (m of messages(); track m.id) {
          <chat-session-message
            class="d-block mb-3"
            [character]="allCharacters() | findCharacter:m.characterId"
            [message]="m"
            (deleteMessageRequest)="onDeleteMessageRequest(m)"/>
        }
      </div>
      <chat-session-chat-input-block
        class="d-block mb-2"
        [worldId]="worldId()"
        [chatSessionId]="chatSessionId()"/>
    </div>
    <div class="g-col-3 h-100 pb-4 overflow-y-auto chat-grid-column">
    </div>
  </div>
</div>
